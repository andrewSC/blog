
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Andrew Scott Crerar</title>
	<meta name="author" content="Andrew Scott Crerar">

	
	<meta name="description" content="I recently went through the setup of my favorite OS, Arch Linux,
on a 2011 Macbook Air (Model: A1369) and decided to keep the Apple bootloader. The &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Andrew Scott Crerar" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Forum' rel='stylesheet' type='text/css'>
	
</head>

<body>
  <div id="wrap">
	<header id="header" class="inner-header"><h1><a href="/">Andrew Scott Crerar</a></h1>
<nav id="sub-nav" class="alignright">
  <div class="social">
      
      <a class="github" href="https://github.com/andrewSC" title="GitHub"><i class="icon-github-alt icon-2x"></i></a>
      
      
      <a class="linkedin" href="http://www.linkedin.com/in/andrewcrerar"><i class="icon-linkedin-sign icon-2x"></i></a>
      
      
      <a class="facebook" href="http://www.facebook.com/andrew.s.crerar" title="Facebook"><i class="icon-facebook-sign icon-2x"></i></a>
      
      
      <a class="google" href="https://plus.google.com/113033075755051153095?rel=author" title="Google+"><i class="icon-google-plus-sign icon-2x"></i></a>
      
      
      <a class="twitter" href="http://twitter.com/andrew_SC" title="Twitter"><i class="icon-twitter-sign icon-2x"></i></a>
      
      
      
      
      
      
      <a class="rss" href="/atom.xml" title="RSS"><i class="icon-rss icon-2x"></i></a>
      
  </div>
    <!--<form class="search" action="http://google.com/search" method="get">-->
    <!--<input class="alignright" type="text" name="q" results="0">-->
    <!--<input type="hidden" name="q" value="site:andrewSC.github.com/blog">-->
    <!--</form>-->
</nav>
</header>
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/03/30/arch-linux/">
		
			Arch Linux, EFISTUB, Gummiboot, and the Apple Bootloader</a>
	</h2>
	<div class="entry-content">
		<p>I recently went through the setup of my favorite OS, <a href="https://www.archlinux.org/">Arch Linux</a>,
on a 2011 Macbook Air (Model: A1369) and decided to keep the Apple bootloader. The main reason
I went down this route was because I wanted to keep the seamless appearance of an Apple product.
Configuring rEFIt to boot OS X as the default would be easy enough to do and I highly recommend that approach
if you&#8217;re not concerned about looks or having OS X as the default without a OS selection prompt.
So yeah, I thought a how-to of the steps involved would possibly help others who want to do this
but need a reference :)</p>

<p>The first step is getting your OS X partition(s) setup correctly and I felt
the <a href="https://wiki.archlinux.org/index.php/MacBook#Mac_OS_X.2C_Windows_XP.2C_and_Arch_Linux_triple_boot">triple boot documentation</a>
was adequate enough to get the idea of what needed to be done. Here is the
procedure (slightly modified for our purposes):</p>

<ol>
<li>In Mac OS X, run Disk Utility (located in /Applications/Utilities).</li>
<li>Select the drive to be partitioned in the left-hand column (not the partitions!). Click on the partition tab on the right.</li>
<li>Select the volume to be resized in the volume scheme.</li>
<li>Decide how much space you wish to have for your Mac OS X partition, and how much
for Arch Linux. Remember that a typical installation of Mac OS X requires around 15-20 GiB.</li>
<li>Go ahead and resize the OS X partition leaving the empty space for Arch Linux later in the installation process.</li>
<li>Finally, click apply. This will resize your partition and make room for Arch!</li>
</ol>


<p>Next step is getting the arch install medium onto a usb drive. I followed
the instructions listed on the <a href="https://wiki.archlinux.org/index.php/USB_Installation_Media">USB Installation Media</a>
page. After you have the USB drive plugged into the laptop and reboot make sure to hold the <code>⌥ option key</code> and select the usb drive
as the boot option.</p>

<p>Great, now you should be presented with a shell prompt and automatically logged
in as root.</p>

<p><strong>NOTE:</strong> I&#8217;m making the assumption that your drive will be <code>/dev/sda</code>. It could very well
be something completely different just be sure to double check with <code>fdisk -l</code> before you
continue.</p>

<ol>
<li><p>Setup your wired/wireless internet connection (<a href="https://wiki.archlinux.org/index.php/Beginners'_guide#Establish_an_internet_connection">Establish an internet connection</a>)</p></li>
<li><p>Verify you&#8217;re booted into UEFI mode by running <code>efivar -l</code>. If efivar lists the uefi variables without any error, then you&#8217;re good to continue</p></li>
<li><p>Run <code>fdisk -l</code> and verify <code>/dev/sda1</code> is of type <code>EFI system</code></p></li>
<li><p><code>cd /boot</code> and <code>mkdir efi</code></p></li>
<li><p><code>mount /dev/sda1 /boot/efi</code></p></li>
<li><p>Run <code>cgdisk /dev/sda</code> and arrow down until you&#8217;ve selected the partition type <code>free space</code></p>

<ul>
<li>Choose <em>New</em> and when the tool prompts you for the First sector enter <code>+128M</code> (OS X likes to see a 128MB gap after partitions)</li>
<li>When the second prompt asks you for the <code>Size in sectors</code> press enter if you want to use the rest of the available disk space.
If you don&#8217;t want to use the rest of the available disk space then enter the size here</li>
<li>Use Hex code 8300 (or press enter as 8300 is the default) for the <code>Hex code or GUID</code> prompt</li>
<li>Enter whatever partition name you would like to have&#8211;I chose Arch Linux as my partition name</li>
<li>Write the changes you&#8217;ve made to disk by selecting <code>Write</code> and typing <code>yes</code> when prompted</li>
</ul>
</li>
<li><p>After partitioning I rebooted then once I was back at a shell I formatted the Arch partition using the
<a href="https://en.wikipedia.org/wiki/Ext4">Ext4</a> file system <code>mkfs.ext4 /dev/sda4</code></p></li>
<li><p>Make sure pacman will use the mirror you want by editing <code>/etc/pacman.d/mirrorlist</code>. I personally prefer <a href="http://www.rit.edu/">RIT</a>
because it&#8217;s my alma mater so the first line in my mirrorlist file is <code>Server = http://mirror.rit.edu/archlinux/$repo/os/$arch</code></p></li>
<li><p>Install the base system! <code>pacstrap -i /mnt base</code> and press enter for the prompts
to install all packages</p></li>
<li><p>Generate your fstab <code>genfstab -U -p /mnt &gt;&gt; /mnt/etc/fstab</code></p></li>
<li><p>chroot into your base system <code>arch-chroot /mnt /bin/bash</code></p></li>
<li><p>At this point I&#8217;m going to defer to the archwiki step of
<a href="https://wiki.archlinux.org/index.php/Beginners'_guide#Chroot_and_configure_the_base_system">Chroot and configure the base system</a>.
Simply follow the wiki until you get to
<a href="https://wiki.archlinux.org/index.php/Beginners'_guide#Install_and_configure_a_bootloader">Install and configure a bootloader</a>
then continue back here</p></li>
<li><p>So now the fun begins. Assuming you&#8217;re still in your chrooted setup run <code>pacman -S gummiboot</code></p></li>
<li><p>Run <code>mkdir /boot/efi</code> and <code>mount /dev/sda1 /boot/efi</code></p></li>
<li><p><code>cd /boot/efi</code> run <code>gummiboot --path=/boot/efi install</code> and create <code>/boot/efi/EFI/arch</code></p></li>
<li><p>copy <code>/boot/vmlinuz-linux</code>, <code>/boot/initramfs-linux.img</code>, and <code>/boot/initramfs-linux-fallback.img</code> to
<code>boot/efi/EFI/arch/vmlinuz-arch.efi</code>, <code>boot/efi/EFI/arch/initramfs-arch.img</code>, and <code>boot/efi/EFI/arch/initramfs-arch-fallback.img</code> respectively.</p></li>
<li><p><code>cd /boot/efi/loader</code> and edit the <code>loader.conf</code> file to be
<pre>
default arch
timeout 10
</pre></p></li>
<li><p><code>cd entries</code> and create a file named <code>arch.conf</code> with the contents of
<pre>
title Arch Linux
efi EFI/arch/vmlinuz-arch.efi
options initrd=EFI/arch/initramfs-arch.img root=/dev/sda4 rw
</pre></p>

<ul>
<li><strong>NOTE:</strong> If you don&#8217;t set the initrd and root paths on the same line you&#8217;ll
get an error along the lines of <code>kernel panic-not syncing: VFS: unable to mount root fs on
unknown block(0,0)</code>.</li>
</ul>
</li>
<li><p><code>reboot</code> the computer and when prompted by gummiboot choose to boot OS X</p></li>
<li><p>Once you&#8217;ve booted into OS X open a terminal and <code>sudo bless -folder /System/Library/CoreServices -setBoot</code></p>

<ul>
<li><strong>NOTE:</strong> this sets the OS X default bootloader back to being the default bootloader</li>
</ul>
</li>
<li><p>Reboot and hold down <code>⌥ option key</code> and select <code>EFI BOOT</code> then select Arch Linux</p></li>
<li><p>enter your login information and <code>mount /dev/sda1 /boot/efi &amp;&amp; cd /boot/efi/loader</code></p></li>
<li><p>edit <code>loader.conf</code> and remove the timeout that was set earlier. Reboot</p></li>
<li><p>Congratulations! You now have a setup that will on default boot to OS X but if you
want to boot into Arch all you need to do is hold down <code>⌥ option key</code> and select the EFI BOOT option!</p></li>
</ol>


<p><strong>EDIT:</strong> One of the things you may want to do is setup systemd so it updates the kernel images on the EFI partition
automatically. I won&#8217;t go into too much detail on this because the wiki does a pretty good job
but definitely take a moment to checkout <a href="https://wiki.archlinux.org/index.php/EFISTUB#Using_systemd">https://wiki.archlinux.org/index.php/EFISTUB#Using_systemd</a></p>

<p>Here&#8217;s the collection of sources I used while working this out:</p>

<ul>
<li><a href="https://wiki.archlinux.org/index.php/EFISTUB">https://wiki.archlinux.org/index.php/EFISTUB</a></li>
<li><a href="https://help.ubuntu.com/community/UEFIBooting">https://help.ubuntu.com/community/UEFIBooting</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Beginners'_guide">https://wiki.archlinux.org/index.php/Beginners&#8217;_guide</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface">https://wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Gummiboot">https://wiki.archlinux.org/index.php/Gummiboot</a></li>
<li><a href="https://wiki.archlinux.org/index.php/MacBook">https://wiki.archlinux.org/index.php/MacBook</a></li>
<li><a href="http://www.freedesktop.org/wiki/Software/gummiboot/">http://www.freedesktop.org/wiki/Software/gummiboot/</a></li>
<li><a href="http://wilkiecat.wordpress.com/2012/02/03/bless-system-in-mac-os-x-if-your-partition-wont-boot/">http://wilkiecat.wordpress.com/2012/02/03/bless-system-in-mac-os-x-if-your-partition-wont-boot/</a></li>
</ul>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-03-30T14:08:00-04:00" pubdate data-updated="true">Mar 30<span>th</span>, 2014</time></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/04/27/lander/">
		
			Lander</a>
	</h2>
	<div class="entry-content">
		<p>Over the past couple of months I&#8217;ve been working on a side project to design a landing-type page which I finally
finished about two weekends ago. Looking back, I now realize finding inspiration was a lot harder than I expected so
I&#8217;ve decided to share some resources I found most helpful. But before I do, I wanted to talk about the design process I
went through. My first effort which took several weekends resulted in this:</p>

<p><img src="http://i.imgur.com/R4glJT5.png"></p>

<p>Initially I was really into the idea of a darker themed website as every dark website I&#8217;d ever seen had a nice look to it.
However, as time went on I started to realize that picking the right color palette as well as the general criticalness that
is a dark background can become a real difficult problem if you don&#8217;t know exactly what you want the end product to look like.
I also felt it was lacking a somewhat professional touch and the fact that I still had two other full sections to design
lead me to a redesign of the entire thing. The picture below is what I ended up with on a Saturday night after scrapping
the entire project a day before.</p>

<p><img src="http://i.imgur.com/iSwj3yi.png"></p>

<p>Basically I had three major things I wanted to be prominent at first glance: content, ease-of-use, and elegance. With my
initial design I missed the content part entirely so that became my focus in the resdesign. Other focuses of mine were to
maintain responsiveness as well as really focus on interation rather than trying to perfect it the first time around.
Anyways, here are some of the links I used for inspiration:</p>

<p><a href="http://onepagelove.com/">http://onepagelove.com/</a><br/>
<a href="http://www.designbombs.com/">http://www.designbombs.com/</a><br/>
<a href="http://www.awwwards.com/">http://www.awwwards.com/</a><br/>
<a href="http://www.siteinspire.com/">http://www.siteinspire.com/</a><br/>
<a href="http://www.siiimple.com/">http://www.siiimple.com/</a><br/>
<a href="http://land-book.com/">http://land-book.com/</a><br/>
<a href="http://www.cssdesignawards.com/">http://www.cssdesignawards.com/</a></p>

<p>These sites are basically showcase sites that other designers have submitted. I also found
<a href="http://www.reddit.com/r/graphic_design">http://www.reddit.com/r/graphic_design</a> and its subreddits to be pretty useful as well.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-04-27T20:34:00-04:00" pubdate data-updated="true">Apr 27<span>th</span>, 2013</time></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/02/16/git-autocompletion-and-bashthings/">
		
			Git Autocompletion and Bashthings</a>
	</h2>
	<div class="entry-content">
		<p><img src="http://i.imgur.com/7LhFQ36.png"></p>

<p>At my work we use Git as a VCS and while Git is very powerful, trying
to remember all those little arguments can become tedious at best.  Great, we established
aliases, autocompletion, and Git alias autocompletion would be nice but how do we go about setting all that up?</p>

<p>The first thing you&#8217;re going to want to do is setup/install the <a href="http://git-scm.com/book/en/Git-Basics-Tips-and-Tricks#Auto-Completion">git-completion.bash</a> script</p>

<p>Next, add these entries into your .bash_profile (for OS X) or .bashrc (for Linux)</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">BASH_GIT_COMPLETION</span><span class="o">=</span><span class="s2">&quot;/usr/local/etc/bash_completion.d/git-completion.bash&quot;</span>
</span><span class='line'><span class="nv">GIT_PS1_SHOWDIRTYSTATE</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>
</span><span class='line'><span class="nv">GIT_PS1_SHOWUPSTREAM</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span>
</span><span class='line'><span class="c">#bash completion</span>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> -f <span class="sb">`</span>brew --prefix<span class="sb">`</span>/etc/bash_completion <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'>     . <span class="sb">`</span>brew --prefix<span class="sb">`</span>/etc/bash_completion
</span><span class='line'><span class="k">fi</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note: the <code>BASH_GIT_COMPLETION</code> path will vary depending on your setup.  As a note, these are my git aliases.  Feel free to use them:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">alias </span><span class="nv">g</span><span class="o">=</span><span class="s1">&#39;git&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">ga</span><span class="o">=</span><span class="s1">&#39;git add&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gaa</span><span class="o">=</span><span class="s1">&#39;git add -A&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gb</span><span class="o">=</span><span class="s1">&#39;git branch&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gba</span><span class="o">=</span><span class="s1">&#39;git branch -a&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gbam</span><span class="o">=</span><span class="s1">&#39;git add . &amp;&amp; git commit -am&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gc</span><span class="o">=</span><span class="s1">&#39;git commit -v&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gca</span><span class="o">=</span><span class="s1">&#39;git commit -v -a&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gcam</span><span class="o">=</span><span class="s1">&#39;git commit -am&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gcm</span><span class="o">=</span><span class="s1">&#39;git commit -m&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gco</span><span class="o">=</span><span class="s1">&#39;git checkout&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gcount</span><span class="o">=</span><span class="s1">&#39;git shortlog -sn&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gcp</span><span class="o">=</span><span class="s1">&#39;git cherry-pick&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gd</span><span class="o">=</span><span class="s1">&#39;git diff&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gdf</span><span class="o">=</span><span class="s1">&#39;git diff --full-index master&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gf</span><span class="o">=</span><span class="s1">&#39;git fetch&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gl</span><span class="o">=</span><span class="s1">&#39;git log --graph --pretty=format:&quot;%C(yellow)%h%Cred%d\\ %Creset%s%Cblue\\ [%cn]&quot; --decorate&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">glg</span><span class="o">=</span><span class="s1">&#39;git log --stat --max-count=5&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">glgg</span><span class="o">=</span><span class="s1">&#39;git log --graph --max-count=5&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">glp</span><span class="o">=</span><span class="s1">&#39;git log --oneline --decorate&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gmt</span><span class="o">=</span><span class="s1">&#39;git mergetool -t diffmerge&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gpo</span><span class="o">=</span><span class="s1">&#39;git pull origin&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">grh</span><span class="o">=</span><span class="s1">&#39;git reset HEAD&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">grhh</span><span class="o">=</span><span class="s1">&#39;git reset HEAD --hard&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">grm</span><span class="o">=</span><span class="s1">&#39;git status | grep deleted | awk &#39;</span><span class="se">\&#39;</span><span class="s1">&#39;{print $3}&#39;</span><span class="se">\&#39;</span><span class="s1">&#39; | xargs git rm&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gs</span><span class="o">=</span><span class="s1">&#39;git status&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gsd</span><span class="o">=</span><span class="s1">&#39;git svn dcommit&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gsr</span><span class="o">=</span><span class="s1">&#39;git svn rebase&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gss</span><span class="o">=</span><span class="s1">&#39;git status -s&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gsu</span><span class="o">=</span><span class="s1">&#39;git submodule&#39;</span>
</span><span class='line'><span class="nb">alias </span><span class="nv">gup</span><span class="o">=</span><span class="s1">&#39;git fetch &amp;&amp; git rebase&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After you&#8217;ve added/source&#8217;d the aliases file into your <code>.bash_profile</code> you can insert/source the <code>alias_completion</code> script</p>

<figure class='code'><figcaption><span>alias_completion </span><a href='http://superuser.com/questions/436314/how-can-i-get-bash-to-perform-tab-completion-for-my-aliases'>Source </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="k">function </span>alias_completion <span class="o">{</span>
</span><span class='line'><span class="nb">local </span><span class="nv">namespace</span><span class="o">=</span><span class="s2">&quot;alias_completion&quot;</span>
</span><span class='line'><span class="nb">local </span><span class="nv">compl_regex</span><span class="o">=</span><span class="s1">&#39;complete( +[^ ]+)* -F ([^ ]+) (&quot;[^&quot;]+&quot;|[^ ]+)&#39;</span>
</span><span class='line'><span class="nb">local </span><span class="nv">alias_regex</span><span class="o">=</span><span class="s2">&quot;alias ([^=]+)=&#39;(\&quot;[^\&quot;]+\&quot;|[^ ]+)(( +[^ ]+)*)&#39;&quot;</span>
</span><span class='line'><span class="nb">eval</span> <span class="s2">&quot;local completions=($(complete -p | sed -Ene &quot;</span>/<span class="nv">$compl_regex</span>/s//<span class="s1">&#39;\3&#39;</span>/p<span class="s2">&quot;))&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="o">((</span> <span class="k">${#</span><span class="nv">completions</span><span class="p">[@]</span><span class="k">}</span> <span class="o">==</span> 0 <span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="k">return </span>0
</span><span class='line'>
</span><span class='line'>rm -f <span class="s2">&quot;/tmp/${namespace}-*.tmp&quot;</span> <span class="c"># preliminary cleanup</span>
</span><span class='line'><span class="nb">local </span><span class="nv">tmp_file</span><span class="o">=</span><span class="s2">&quot;$(mktemp &quot;</span>/tmp/<span class="k">${</span><span class="nv">namespace</span><span class="k">}</span>-<span class="k">${</span><span class="nv">RANDOM</span><span class="k">}</span>.tmp<span class="s2">&quot;)&quot;</span> <span class="o">||</span> <span class="k">return </span>1
</span><span class='line'>
</span><span class='line'><span class="nb">local </span>line; <span class="k">while </span><span class="nb">read </span>line; <span class="k">do</span>
</span><span class='line'><span class="nb">eval</span> <span class="s2">&quot;local alias_tokens=($line)&quot;</span> 2&gt;/dev/null <span class="o">||</span> <span class="k">continue</span> <span class="c"># some alias arg patterns cause an eval parse error</span>
</span><span class='line'><span class="nb">local </span><span class="nv">alias_name</span><span class="o">=</span><span class="s2">&quot;${alias_tokens[0]}&quot;</span> <span class="nv">alias_cmd</span><span class="o">=</span><span class="s2">&quot;${alias_tokens[1]}&quot;</span> <span class="nv">alias_args</span><span class="o">=</span><span class="s2">&quot;${alias_tokens[2]# }&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">eval</span> <span class="s2">&quot;local alias_arg_words=($alias_args)&quot;</span> 2&gt;/dev/null <span class="o">||</span> <span class="k">continue</span>
</span><span class='line'>
</span><span class='line'><span class="o">[[</span> <span class="s2">&quot; ${completions[*]} &quot;</span> <span class="o">=</span>~ <span class="s2">&quot; $alias_cmd &quot;</span> <span class="o">]]</span> <span class="o">||</span> <span class="k">continue</span>
</span><span class='line'><span class="nb">local </span><span class="nv">new_completion</span><span class="o">=</span><span class="s2">&quot;$(complete -p &quot;</span><span class="nv">$alias_cmd</span><span class="s2">&quot;)&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c"># create a wrapper inserting the alias arguments if any</span>
</span><span class='line'><span class="k">if</span> <span class="o">[[</span> -n <span class="nv">$alias_args</span> <span class="o">]]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">  </span><span class="nb">local </span><span class="nv">compl_func</span><span class="o">=</span><span class="s2">&quot;${new_completion/#* -F /}&quot;</span>; <span class="nv">compl_func</span><span class="o">=</span><span class="s2">&quot;${compl_func%% *}&quot;</span>
</span><span class='line'>  <span class="c"># avoid recursive call loops by ignoring our own functions</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;${compl_func#_$namespace::}&quot;</span> <span class="o">==</span> <span class="nv">$compl_func</span> <span class="o">]]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">      </span><span class="nb">local </span><span class="nv">compl_wrapper</span><span class="o">=</span><span class="s2">&quot;_${namespace}::${alias_name}&quot;</span>
</span><span class='line'>      <span class="nb">echo</span> <span class="s2">&quot;function $compl_wrapper {</span>
</span><span class='line'><span class="s2">     (( COMP_CWORD += ${#alias_arg_words[@]} ))</span>
</span><span class='line'><span class="s2">     COMP_WORDS=($alias_cmd $alias_args \${COMP_WORDS[@]:1})</span>
</span><span class='line'><span class="s2">     $compl_func</span>
</span><span class='line'><span class="s2"> }&quot;</span> &gt;&gt; <span class="s2">&quot;$tmp_file&quot;</span>
</span><span class='line'>  <span class="nv">new_completion</span><span class="o">=</span><span class="s2">&quot;${new_completion/ -F $compl_func / -F $compl_wrapper }&quot;</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'><span class="k">  fi</span>
</span><span class='line'><span class="k">  </span><span class="nv">new_completion</span><span class="o">=</span><span class="s2">&quot;${new_completion% *} $alias_name&quot;</span>
</span><span class='line'>  <span class="nb">echo</span> <span class="s2">&quot;$new_completion&quot;</span> &gt;&gt; <span class="s2">&quot;$tmp_file&quot;</span>
</span><span class='line'><span class="k">done</span> &lt; &lt;<span class="o">(</span><span class="nb">alias</span> -p | sed -Ene <span class="s2">&quot;s/$alias_regex/\1 &#39;\2&#39; &#39;\3&#39;/p&quot;</span><span class="o">)</span>
</span><span class='line'><span class="nb">source</span> <span class="s2">&quot;$tmp_file&quot;</span> <span class="o">&amp;&amp;</span> rm -f <span class="s2">&quot;$tmp_file&quot;</span>
</span><span class='line'><span class="o">}</span>; alias_completion
</span></code></pre></td></tr></table></div></figure>


<p>Add PS1 prompt gaudiness</p>

<figure class='code'><figcaption><span>PS1 prompt </span><a href='https://github.com/necolas/dotfiles'>Source </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="k">if</span> <span class="o">[[</span> <span class="nv">$COLORTERM</span> <span class="o">=</span> gnome-* <span class="o">&amp;&amp;</span> <span class="nv">$TERM</span> <span class="o">=</span> xterm <span class="o">]]</span> <span class="o">&amp;&amp;</span> infocmp gnome-256color &gt;/dev/null 2&gt;&amp;1; <span class="k">then</span>
</span><span class='line'><span class="k">  </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>gnome-256color
</span><span class='line'><span class="k">elif </span>infocmp xterm-256color &gt;/dev/null 2&gt;&amp;1; <span class="k">then</span>
</span><span class='line'><span class="k">  </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>screen-256color
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>tput sgr 0 0
</span><span class='line'>
</span><span class='line'><span class="nv">BOLD</span><span class="o">=</span><span class="k">$(</span>tput bold<span class="k">)</span>
</span><span class='line'><span class="nv">RESET</span><span class="o">=</span><span class="k">$(</span>tput sgr0<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_YELLOW</span><span class="o">=</span><span class="k">$(</span>tput setaf 136<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_ORANGE</span><span class="o">=</span><span class="k">$(</span>tput setaf 166<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_RED</span><span class="o">=</span><span class="k">$(</span>tput setaf 124<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_MAGENTA</span><span class="o">=</span><span class="k">$(</span>tput setaf 125<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_VIOLET</span><span class="o">=</span><span class="k">$(</span>tput setaf 61<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_BLUE</span><span class="o">=</span><span class="k">$(</span>tput setaf 33<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_CYAN</span><span class="o">=</span><span class="k">$(</span>tput setaf 37<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_GREEN</span><span class="o">=</span><span class="k">$(</span>tput setaf 64<span class="k">)</span>
</span><span class='line'><span class="nv">SOLAR_WHITE</span><span class="o">=</span><span class="k">$(</span>tput setaf 254<span class="k">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">style_user</span><span class="o">=</span><span class="s2">&quot;\[${RESET}${SOLAR_ORANGE}\]&quot;</span>
</span><span class='line'><span class="nv">style_host</span><span class="o">=</span><span class="s2">&quot;\[${RESET}${SOLAR_YELLOW}\]&quot;</span>
</span><span class='line'><span class="nv">style_path</span><span class="o">=</span><span class="s2">&quot;\[${RESET}${SOLAR_GREEN}\]&quot;</span>
</span><span class='line'><span class="nv">style_chars</span><span class="o">=</span><span class="s2">&quot;\[${RESET}${SOLAR_WHITE}\]&quot;</span>
</span><span class='line'><span class="nv">style_branch</span><span class="o">=</span><span class="s2">&quot;${SOLAR_CYAN}&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;$SSH_TTY&quot;</span> <span class="o">]]</span>; <span class="k">then</span>
</span><span class='line'>  <span class="c"># connected via ssh</span>
</span><span class='line'>  <span class="nv">style_host</span><span class="o">=</span><span class="s2">&quot;\[${BOLD}${SOLAR_RED}\]&quot;</span>
</span><span class='line'><span class="k">elif</span> <span class="o">[[</span> <span class="s2">&quot;$USER&quot;</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="o">]]</span>; <span class="k">then</span>
</span><span class='line'>  <span class="c"># logged in as root</span>
</span><span class='line'>  <span class="nv">style_user</span><span class="o">=</span><span class="s2">&quot;\[${BOLD}${SOLAR_RED}\]&quot;</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'>is_git_repo<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">$(</span>git rev-parse --is-inside-work-tree &amp;&gt; /dev/null<span class="k">)</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>is_git_dir<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">$(</span>git rev-parse --is-inside-git-dir 2&gt; /dev/null<span class="k">)</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>get_git_branch<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="nb">local </span>branch_name
</span><span class='line'>
</span><span class='line'>  <span class="c"># Get the short symbolic ref</span>
</span><span class='line'>  <span class="nv">branch_name</span><span class="o">=</span><span class="k">$(</span>git symbolic-ref --quiet --short HEAD 2&gt; /dev/null<span class="k">)</span> <span class="o">||</span>
</span><span class='line'>      <span class="c"># If HEAD isn&#39;t a symbolic ref, get the short SHA</span>
</span><span class='line'>  <span class="nv">branch_name</span><span class="o">=</span><span class="k">$(</span>git rev-parse --short HEAD 2&gt; /dev/null<span class="k">)</span> <span class="o">||</span>
</span><span class='line'>      <span class="c"># Otherwise, just give up</span>
</span><span class='line'>  <span class="nv">branch_name</span><span class="o">=</span><span class="s2">&quot;(unknown)&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">printf</span> <span class="nv">$branch_name</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Git status information</span>
</span><span class='line'>prompt_git<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="nb">local </span>git_info git_state uc us ut st
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> ! is_git_repo <span class="o">||</span> is_git_dir; <span class="k">then</span>
</span><span class='line'><span class="k">      return </span>1
</span><span class='line'>  <span class="k">fi</span>
</span><span class='line'>
</span><span class='line'><span class="k">  </span><span class="nv">git_info</span><span class="o">=</span><span class="k">$(</span>get_git_branch<span class="k">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># Check for uncommitted changes in the index</span>
</span><span class='line'>  <span class="k">if</span> ! <span class="k">$(</span>git diff --quiet --ignore-submodules --cached<span class="k">)</span>; <span class="k">then</span>
</span><span class='line'><span class="k">      </span><span class="nv">uc</span><span class="o">=</span><span class="s2">&quot;+&quot;</span>
</span><span class='line'>  <span class="k">fi</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># Check for unstaged changes</span>
</span><span class='line'>  <span class="k">if</span> ! <span class="k">$(</span>git diff-files --quiet --ignore-submodules --<span class="k">)</span>; <span class="k">then</span>
</span><span class='line'><span class="k">      </span><span class="nv">us</span><span class="o">=</span><span class="s2">&quot;!&quot;</span>
</span><span class='line'>  <span class="k">fi</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># Check for untracked files</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;$(git ls-files --others --exclude-standard)&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">      </span><span class="nv">ut</span><span class="o">=</span><span class="s2">&quot;?&quot;</span>
</span><span class='line'>  <span class="k">fi</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># Check for stashed files</span>
</span><span class='line'>  <span class="k">if</span> <span class="k">$(</span>git rev-parse --verify refs/stash &amp;&gt;/dev/null<span class="k">)</span>; <span class="k">then</span>
</span><span class='line'><span class="k">      </span><span class="nv">st</span><span class="o">=</span><span class="s2">&quot;$&quot;</span>
</span><span class='line'>  <span class="k">fi</span>
</span><span class='line'>
</span><span class='line'><span class="k">  </span><span class="nv">git_state</span><span class="o">=</span><span class="nv">$uc$us$ut$st</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># Combine the branch name and state information</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$git_state</span> <span class="o">]]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">      </span><span class="nv">git_info</span><span class="o">=</span><span class="s2">&quot;$git_info[$git_state]&quot;</span>
</span><span class='line'>  <span class="k">fi</span>
</span><span class='line'>
</span><span class='line'><span class="k">  </span><span class="nb">printf</span> <span class="s2">&quot;${SOLAR_WHITE} on ${style_branch}${git_info}&quot;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Set the terminal title to the current working directory</span>
</span><span class='line'><span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;\[\033]0;\w\007\]&quot;</span>
</span><span class='line'><span class="c"># Build the prompt</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;\n&quot;</span> <span class="c"># Newline</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;${style_user}\u&quot;</span> <span class="c"># Username</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;${style_chars}@&quot;</span> <span class="c"># @</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;${style_host}\h&quot;</span> <span class="c"># Host</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;${style_chars}: &quot;</span> <span class="c"># :</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;${style_path}\w&quot;</span> <span class="c"># Working directory</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;\$(prompt_git)&quot;</span> <span class="c"># Git details</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;\n&quot;</span> <span class="c"># Newline</span>
</span><span class='line'>PS1+<span class="o">=</span><span class="s2">&quot;${style_chars}\$ \[${RESET}\]&quot;</span> <span class="c"># $ (and reset color)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, man page stuff</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># Setting colorized man pages</span>
</span><span class='line'><span class="nb">export </span><span class="nv">LESS_TERMCAP_mb</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;\033[38;5;92m&#39;</span><span class="k">)</span> <span class="c"># enter blinking mode - red</span>
</span><span class='line'><span class="nb">export </span><span class="nv">LESS_TERMCAP_md</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;\033[38;5;84m&#39;</span><span class="k">)</span> <span class="c"># enter double-bright mode - bold, magenta</span>
</span><span class='line'><span class="nb">export </span><span class="nv">LESS_TERMCAP_me</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;\e[0m&#39;</span><span class="k">)</span> <span class="c"># turn off all appearance modes (mb, md, so, us)</span>
</span><span class='line'><span class="nb">export </span><span class="nv">LESS_TERMCAP_se</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;\e[0m&#39;</span><span class="k">)</span> <span class="c"># leave standout mode</span>
</span><span class='line'><span class="nb">export </span><span class="nv">LESS_TERMCAP_so</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;\033[38;5;196m&#39;</span><span class="k">)</span> <span class="c"># enter standout mode - yellow</span>
</span><span class='line'><span class="nb">export </span><span class="nv">LESS_TERMCAP_ue</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;\e[0m&#39;</span><span class="k">)</span> <span class="c"># leave underline mode</span>
</span><span class='line'><span class="nb">export </span><span class="nv">LESS_TERMCAP_us</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s1">&#39;\033[38;5;208m&#39;</span><span class="k">)</span> <span class="c"># enter underline mode - cyan</span>
</span></code></pre></td></tr></table></div></figure>


<p>Latest hotness? Check out the github repo: <a href="https://github.com/andrewSC/bash_profile">https://github.com/andrewSC/bash_profile</a> (´◔◞౪◟◔)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-02-16T14:12:00-05:00" pubdate data-updated="true">Feb 16<span>th</span>, 2013</time></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/01/20/archp1/">
		
			Euclid</a>
	</h2>
	<div class="entry-content">
		<p>SO, this Christmas I was gifted a couple computer parts for a tower refresh and
this weekend I made some time to put everything together and install Arch Linux
on it. Since it’s been quite some time since I had installed Arch a lot has
changed and it took me a while to come around and figure stuff out. Seeing as
I’m doing something a little one-offish I thought it might be nice to share what
I did so people who might be trying to do roughly the same thing can see how I
approached this beast.</p>

<p>The Setup</p>

<ul>
<li>Asus Sabertooth X79</li>
<li>Intel i7 Sandy Bridge 3.6Ghz Quad Core</li>
<li>32GB G. Skill DDR3 ram at 1600Mhz</li>
<li>(2) OCZ Vertex 4 SATA III drives</li>
</ul>


<p>The OS</p>

<ul>
<li>Arch Linux 2013.01.04</li>
<li>GPT</li>
<li>UEFI</li>
<li>efibootmgr</li>
<li>LVM2 (software raid-0 with two drives)</li>
</ul>


<h2>Steps</h2>

<ol>
<li><p>Download the latest Arch Linux iso and dd it to your thumb drive.
Since I run off of an MBA most of the time, OS X commands are a little
different:
<pre>
diskutil unmountDisk /dev/disk1 dd
if=/path/to/archlinuxisoyoudownloaded.iso of=/dev/disk1 bs=8192
diskutil eject /dev/disk1
</pre>
More information can be found at: <a href="https://wiki.archlinux.org/index.php/USB_Installation_Media">Archwiki - USB installation media</a></p></li>
<li><p>Put that bad boy into a usb slot on your machine and boot it.  Once you’re
at the terminal and logged in as root (should automagically happen) go ahead
and pull up gdisk for /dev/sda: <code>gdisk /dev/sda</code> In gdisk you’ll see:</p>

<ul>
<li><code>Command (? for help):</code>

<ul>
<li>Type <code>n</code></li>
<li>Leave Partition number blank</li>
<li>Leave First sector blank</li>
<li>Type <code>+1G</code> for the Last sector field</li>
<li>Type <code>EF00</code> for the Hex code</li>
</ul>
</li>
</ul>


<p>Repeat the steps in 2 again but this time leave the <code>Last sector</code> field blank.
For the Hex code you’ll want to type <code>8E00</code>.
Go ahead and write these changes to disk by typing <code>w</code>.
You can verify everything was done correctly by using</p>

<ul>
<li><code>fdisk -l</code></li>
<li><code>lsblk</code></li>
</ul>


<p>to verify the partitions are there.
More info can be found <a href="http://www.rodsbooks.com/gdisk/walkthrough.html">here</a> and <a href="https://wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface#Create_an_UEFI_System_Partition_in_Linux">here</a>.</p></li>
<li><p>Next we’re going to setup LVM2.  Go ahead and type:
<pre>
pvcreate —dataalignment 1m /dev/sda2
pvcreate —dataalignment 1m /dev/sdb1
</pre>
You can verify the physical volumes were created by typing <code>pvdisplay</code></p></li>
<li><p>Create the volume group:
<pre>
vgcreate VolGroup00 /dev/sda2
vgextend VolGroup00 /dev/sdb1
</pre>
Again, you can verify everything went a-okay with <code>vgdisplay</code></p></li>
<li><p>Create the logical volume:
<pre>
lvcreate -L 220G VolGroup00 -n lveuclid
</pre>
You can change the size of the volume later if 220 Gigabytes isn’t your thing.
Also, <code>lveuclid</code> is just what I’m naming this volume, you can name yours whatever you like.</p></li>
<li><p>Create the file systems:
<pre>
mkfs.vfat -F32 /dev/sda1
mkfs.ext4 /dev/mapper/VolGroup00-lveuclid
</pre></p></li>
<li><p>Mount!!!!
<pre>
mount /dev/mapper/VolGroup00-lveuclid /mnt
mkdir /mnt/boot/efi
mount /dev/sda1 /mnt/boot/efi
</pre></p></li>
<li><p>Install!!!! Make sure to put a fast server mirror in mirror list. Just add the <code>Server =</code> line
to the top of the file:
<pre>
nano /etc/pacman.d/mirrorlist
Server = http://mirror.rit.edu/archlinux/$repo/os/$arch
pacstrap /mnt base base-devel
</pre>
From here on out I just followed the Beginners guide as it breaks everything down fairly nicely <a href="https://wiki.archlinux.org/index.php/Beginners'_Guide">Arch Linux - Beginners guide</a>
Be sure to add <code>lvm</code> to your hooks array in mkinitcpio.conf and re-generate. Also, for <code>efibootmgr</code> just follow these steps: <a href="https://wiki.archlinux.org/index.php/UEFI_Bootloaders#Using_efibootmgr_entry">Arch Linux - UEFI bootloaders</a></p></li>
</ol>


<p><strong>NOTES</strong></p>

<ul>
<li>If you ever need to go back into the installer env. to do something on the LVM raid you created, to mount the LVM raid:
<pre>
modprobe dm-mod
vgscan
vgchange –ay
mount /dev/mapper/yourlvmvolumenamehere /mnt
</pre></li>
<li>If you are trying to boot the volume be sure to use the UUID of the LVM volume <strong>NOT the partUUID</strong> as the archwiki suggests:
<pre>
root=UUID=yourguidhere
</pre></li>
</ul>


<p>Honestly I’m pretty happy with this setup.
You can see my boot times:</p>

<p><img src="http://i.imgur.com/lYIgI.png">
In terms of raw performance in read/write, I’m still working out the kinks
but I’m getting around 600MB/s read and about ~460MB/s write.
It’s not great but I’m sure there’s something I can tweak to pick these
numbers up around the 900s like many people are reporting in windowsland.</p>

<p>Finally, many many extra credit andy points if you got the <a href="http://en.wikipedia.org/wiki/Pi_%28film%29">euclid</a> reference (yes, it actually is my hostname).  If you have any questions don’t hesitate to contact me (´◔◞౪◟◔)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-20T21:36:00-05:00" pubdate data-updated="true">Jan 20<span>th</span>, 2013</time></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/01/20/reminder/">
		
			Friendly Reminder</a>
	</h2>
	<div class="entry-content">
		<h5>The single most important reason to create a routine is to reduce a program’s complexity.  Create a routine to hide information so that you won’t need to think about it.  Sure, you’ll need to think about it when you write the routine.  But after it’s written, you should be able to forget the details and use the routine without any knowledge of its internal workings.  Other reasons to create routines—minimizing code size, improving maintainability, and improving correctness—are also good reasons, but without the abstractive power of routines, complex programs would be impossible to manage intellectually.</h5>

<h3>A indication that a routine needs to be broken out of another routine is deep nesting of an inner loop or a conditional.  Reduce the containing routine’s complexity by pulling the nested part out and putting it into its own routine.</h3>

<p>p. 164 <a href="http://en.wikipedia.org/wiki/Code_Complete">Code Complete</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-20T21:20:00-05:00" pubdate data-updated="true">Jan 20<span>th</span>, 2013</time></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/01/19/trackpad/">
		
			Trackpad, You Suck</a>
	</h2>
	<div class="entry-content">
		<p>Hi all,</p>

<p>So over the past month or so I’ve been having some pretty xtreme issues with my 2011 Apple Macbook Air 13” and to put it lightly, they could have been a real deal breaker if I hadn’t backed my data up. Basically it started with my laptop intermittently freezing. Now these freezes weren’t the easiest kind to diagnose because their timings were inconsistent/I couldn’t trigger the lockup through a series of repeatable actions. Basically  the only way out of these things was to do a hard reset (I tried waiting out the pinwheel of death, iLost). Finally, after about three months of inconsistent lockups the SSD progressed to complete NAND/SSD controller failure.</p>

<p>Because I’m the genius that I am, I had everything backed up to a TimeMachine on my RAID 1 NAS so I didn’t lose any data but it did bring my productivity to a grinding halt for the rest of the day. I ended up spending the next six or so hours waiting for TimeMachine to restore the latest backup to the original SSD. Once that was done, I had my wheels back. OR SO I THOUGHT <em>dun dun dun</em></p>

<p>About a week later I started having some very odd trackpad issues (f*** me, right?). The trackpad would emote from time to time and click-n-drag all the things or assume I was dragging my knuckles all over it in an attempt to click the proper tab on my web browser. Well, it got to the point where I had had enough and decided to take destiny by the reins (whoa)</p>

<p>First, I placed an order with <a href="http://bit.ly/Riv5u0">iFixit</a></p>

<p>Second, I printed <a href="http://bit.ly/RiAGRb">this</a> guide.</p>

<p>Third, I disassembled my laptop:</p>

<p><img src="http://i.imgur.com/OYcbC.jpg" width="700" height="700">
<img src="http://i.imgur.com/44Bad.jpg" width="700" height="700">
<img src="http://i.imgur.com/prD02.jpg" width="700" height="700">
<img src="http://i.imgur.com/fQVly.jpg" width="700" height="700">
<img src="http://i.imgur.com/DwMCh.jpg" width="700" height="700">
<img src="http://i.imgur.com/Sxdu4.jpg" width="700" height="700">
<img src="http://i.imgur.com/51xHn.jpg" width="700" height="700">
<img src="http://i.imgur.com/sHlym.jpg" width="700" height="700">
<img src="http://i.imgur.com/nCV7F.jpg" width="700" height="700"><br/>
Voilà! and that completes my trackpad superfuntime.gif replacement experience.  Honestly I was expecting it to be much worse given the recent reviews about how Macbooks are becoming incredibly difficult to repair. However, compared to my Acer Ferrari 4000, this was painless.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-19T18:23:00-05:00" pubdate data-updated="true">Jan 19<span>th</span>, 2013</time></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/01/19/hmm/">
		
			Hmm, Where Were We?</a>
	</h2>
	<div class="entry-content">
		<p>Hi everyone!</p>

<p>Today is a pretty exciting day because I’m starting my own blog!  Over the past several weeks I’ve had a real hankering to post what I’ve been working on academically as well as my personal Adventure Time adventures with Arch Linux system administration/installing things/computer.  So besides posting all that cool geometric mess I want to work on these things, long termskis:</p>

<p>+Better writing/grammar in short format, for the win.
Provide some way for others to see what I <em>actually</em> do when I’m too busy to brohang.exif
Make notes for my future self so if I durp and have to redo something on an older machine I can be like: “Oh yeah, math that, this is how I did it”.
As I think of more reasons to have a blog I’ll be sure to post them (´◔◞౪◟◔)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-01-19T14:23:00-05:00" pubdate data-updated="true">Jan 19<span>th</span>, 2013</time></div>
	
</div></article>

<nav id="pagenavi">
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">    <span class="notice">
        Copyright &copy; 2014
        
            Andrew Scott Crerar
        
    </span>
</footer>
        <script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'andrewsc';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-37728168-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



  </div>
</body>
</html>
